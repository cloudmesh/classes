<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>NIST Pedestrian and Face Detection &#8212; Big Data Classes</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Draft',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          classes</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../i523/2017/index.html">i523</a></li>
                <li><a href="../lesson/index.html">Lessons</a></li>
                <li><a href="../changelog.html">Changes</a></li>
                <li><a href="https://github.com/cloudmesh/classes">Fork</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../i523/2017/index.html">I523 Big Data Applications and Analytics (2017)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i523/2017/index.html#content">Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2017/index.html#additional-content">Additional Content</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i523/2016/index.html">I523 Big Data Applications and Analytics (2016)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/course.html">Syllabus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/refcards.html">Refcards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/assignments/assignments.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/gitlab.html">Gitlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/python_big_data.html">Python for Big Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/python_lesson1.html">Python Fingerprint Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/refcards.html">Refcards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/linux.html">4.1. Linux Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/doc/latex.html">2.2. LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/ubuntu.html">Ubuntu Development Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/ssh.html">Using SSH Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/n-resources.html">Homework References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/contrib/contributing.html">1.5. Contributing</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../i524/2017/index.html">I524 Big Data and Open Source Software Projects (2017)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/preface/index.html">Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/overview.html">i524 Big Data and Open Source Software Projects (2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/calendar.html">I524 Calendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/lectures.html">I524 Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/assignments.html">I524 Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/hids-techs.html">HID Assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/technologies.html">Technologies</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../icloud/2017/index.html">B534 Cloud Computing (2018)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../icloud/2017/index.html#content">Content</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-prerequisites-for-this-class">What are the prerequisites for this class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-full-time-student-at-iupui-can-i-take-the-online-version">I am full time student at IUPUI. Can I take the online version?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-a-residential-student-at-iu-can-i-take-the-online-version-only">I am a residential student at IU. Can I take the online version only?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#the-class-is-full-what-do-i-do">The class is full what do I do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-to-buy-a-textbook">Do I need to buy a textbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-a-computer-to-participate-in-this-class">Do I need a computer to participate in this class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#where-is-the-official-iu-calendar-for-the-fall">Where is the official IU calendar for the Fall?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-do-i-ask-a-question">How do I ask a question?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-write-a-research-article-on-computer-science">How to write a research article on computer science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#which-bibliography-manager-is-required-for-the-class">Which bibliography manager is required for the class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#can-i-use-endnote-or-other-bibliography-managers">Can I use endnote or other bibliography managers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#plagiarism-test-and-resources-related-to-that">Plagiarism test and resources related to that</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-many-hours-will-this-course-take-to-work-on-every-week">How many hours will this course take to work on every week?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#is-all-classes-material-final">Is all classes material final?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-changes-to-the-web-page">What are the changes to the web page?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-lectures-should-i-learn-when">What lectures should I learn when?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-are-you-doing-the-papers">I524: Why are you doing the papers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-are-there-no-homework-to-test-me-on-skills-such-as-ansible-or-python">I524: Why are there no homework to test me on skills such as ansible or python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-not-use-chef-or-another-devops-framework">I524: Why not use chef or another DevOps framework?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-lost">I am lost?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-do-not-like-technology-topic-project-etc">I do not like Technology/Topic/Project/etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-not-able-to-attend-the-online-hours">I am not able to attend the online hours</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-to-attend-the-online-sessions">Do I need to attend the online sessions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-leaning-outcomes">What are the leaning outcomes?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#there-are-so-many-messages-on-piazza-i-can-not-keep-up">There are so many messages on Piazza I can not keep up.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-do-not-know-python-what-do-i-do">I do not know python. What do I do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-techlist-1-homework">Tips: TechList.1 homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#citations">Citations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#spelling">Spelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#github">Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#rubric">Rubric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#timeliness">Timeliness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#outdated-tech-ology">Outdated Tech ology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#techlist-1-and-paper-1-pagecount">Techlist 1 and Paper 1 : Pagecount</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-to-install-virtualbox">Tips to Install Virtualbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-generate-the-ssh-key-on-ubuntu-vm">Do I generate the SSH key on Ubuntu VM ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#ways-to-run-ubuntu-on-windows-10">Ways to run Ubuntu on Windows 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#don-t-use-anaconda">Don’t use Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#using-ssh-key-for-git-push">Using SSH Key for Git Push</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#can-i-write-the-papers-on-osx">Can I write the papers on OSX?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-is-the-nature-of-team-collaboration-on-papers">What is the nature of team collaboration on papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#id1">What is the nature of team collaboration on papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-due-dates-for-assignments">What are the due dates for assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-good-places-to-find-refernce-entries">What are good places to find refernce entries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-install-matplotlib">How to install Matplotlib?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-test-if-your-os-can-install-cloudmesh-client">How to test if your OS can install cloudmesh_client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#windows">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#os-x">OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#linux">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-to-write-a-good-paper">Tips to write a Good Paper</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson/index.html">Lessons</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lesson/cloud/index.html">Cloud (under construction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/contrib/index.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/doc/index.html">Writing Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/index.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/org/index.html">Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/index.html">Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/data/index.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/projects/index.html">Software Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/projects/draft.html">Software Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/iaas/index.html">IaaS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/docker/index.html">Docker Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/ansible/index.html">Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/chef.html">Chef</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/comparison.html">Compaprison of Configuration management software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/composite_cluster.html">Composite Clusters (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/deployment.html">Dynamic deployment of arbitrary X software on VC (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/hadoop.html">Hadoop Virtual Cluster Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/juju.html">Ubuntu Juju</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/mongodb_cluster.html">MongoDB Virtual Cluster (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/openmpi_cluster.html">OpenMPI Virtual Cluster (Under Preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/openstack_heat.html">OpenStack Heat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/other.html">Other (Under Preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/overview.html">DevOps (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/overview_vc.html">Overview Virtual Cluster (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/puppet.html">Puppet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/saltstack-ex1-output.html">Full Message of <code class="docutils literal"><span class="pre">salt-call</span></code> Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/saltstack.html">SaltStack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Notebooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">Todos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../todo.html#general">General</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-unreleased">%%version%% (unreleased)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id1">3.2.0 (2017-08-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id5">3.1.1 (2017-02-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id10">3.1.0 (2017-02-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id15">3.0.9 (2017-01-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id20">3.0.8 (2017-01-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id24">3.0.7 (2017-01-20)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id29">3.0.6 (2017-01-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id32">3.0.5 (2017-01-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id37">3.0.4 (2017-01-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id38">3.0.3 (2017-01-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id41">3.0.2 (2017-01-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id42">3.0.1 (2017-01-06)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id43">3.0 (2017-01-06)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">NIST Pedestrian and Face Detection</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#inria-person-dataset">INRIA Person Dataset</a></li>
<li><a class="reference internal" href="#hog-with-svm-model">HOG with SVM model</a></li>
<li><a class="reference internal" href="#ansible-automation-tool">Ansible Automation Tool</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deployment-by-ansible">Deployment by Ansible</a></li>
<li><a class="reference internal" href="#cloudmesh-for-provisioning">Cloudmesh for Provisioning</a></li>
<li><a class="reference internal" href="#roles-explained-for-installation">Roles Explained for Installation</a><ul>
<li><a class="reference internal" href="#server-groups-for-masters-slaves-by-ansible-inventory">Server groups for Masters/Slaves by Ansible inventory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instructions-for-deployment">Instructions for Deployment</a><ul>
<li><a class="reference internal" href="#cloning-pedestrian-detection-repository-from-github">Cloning Pedestrian Detection Repository from Github</a></li>
<li><a class="reference internal" href="#ansible-playbook">Ansible Playbook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opencv-in-python">OpenCV in Python</a><ul>
<li><a class="reference internal" href="#import-cv2">Import cv2</a></li>
<li><a class="reference internal" href="#image-detection">Image Detection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#human-and-face-detection-in-opencv">Human and Face Detection in OpenCV</a><ul>
<li><a class="reference internal" href="#id1">INRIA Person Dataset</a></li>
<li><a class="reference internal" href="#face-detection-using-haar-cascades">Face Detection using Haar Cascades</a></li>
<li><a class="reference internal" href="#face-detection-python-code-snippet">Face Detection Python Code Snippet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pedestrian-detection-using-hog-descriptor">Pedestrian Detection using HOG Descriptor</a><ul>
<li><a class="reference internal" href="#python-code-snippet">Python Code Snippet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#processing-by-apache-spark">Processing by Apache Spark</a><ul>
<li><a class="reference internal" href="#parallelize-in-spark-context">Parallelize in Spark Context</a></li>
<li><a class="reference internal" href="#map-function-apply-batch">Map Function (apply_batch)</a></li>
<li><a class="reference internal" href="#collect-function">Collect Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results-for-100-images-by-spark-cluster">Results for 100+ images by Spark Cluster</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../i523/2017/index.html">I523 Big Data Applications and Analytics (2017)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i523/2017/index.html#content">Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2017/index.html#additional-content">Additional Content</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i523/2016/index.html">I523 Big Data Applications and Analytics (2016)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/course.html">Syllabus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/refcards.html">Refcards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/assignments/assignments.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/gitlab.html">Gitlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/python_big_data.html">Python for Big Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/python_lesson1.html">Python Fingerprint Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/refcards.html">Refcards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/linux.html">4.1. Linux Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/doc/latex.html">2.2. LaTeX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/ubuntu.html">Ubuntu Development Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/ssh.html">Using SSH Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i523/2016/n-resources.html">Homework References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/contrib/contributing.html">1.5. Contributing</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../i524/2017/index.html">I524 Big Data and Open Source Software Projects (2017)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/preface/index.html">Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/overview.html">i524 Big Data and Open Source Software Projects (2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/calendar.html">I524 Calendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/lectures.html">I524 Lectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/assignments.html">I524 Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/hids-techs.html">HID Assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i524/2017/technologies.html">Technologies</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../icloud/2017/index.html">B534 Cloud Computing (2018)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../icloud/2017/index.html#content">Content</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-prerequisites-for-this-class">What are the prerequisites for this class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-full-time-student-at-iupui-can-i-take-the-online-version">I am full time student at IUPUI. Can I take the online version?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-a-residential-student-at-iu-can-i-take-the-online-version-only">I am a residential student at IU. Can I take the online version only?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#the-class-is-full-what-do-i-do">The class is full what do I do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-to-buy-a-textbook">Do I need to buy a textbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-a-computer-to-participate-in-this-class">Do I need a computer to participate in this class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#where-is-the-official-iu-calendar-for-the-fall">Where is the official IU calendar for the Fall?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-do-i-ask-a-question">How do I ask a question?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-write-a-research-article-on-computer-science">How to write a research article on computer science?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#which-bibliography-manager-is-required-for-the-class">Which bibliography manager is required for the class?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#can-i-use-endnote-or-other-bibliography-managers">Can I use endnote or other bibliography managers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#plagiarism-test-and-resources-related-to-that">Plagiarism test and resources related to that</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-many-hours-will-this-course-take-to-work-on-every-week">How many hours will this course take to work on every week?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#is-all-classes-material-final">Is all classes material final?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-changes-to-the-web-page">What are the changes to the web page?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-lectures-should-i-learn-when">What lectures should I learn when?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-are-you-doing-the-papers">I524: Why are you doing the papers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-are-there-no-homework-to-test-me-on-skills-such-as-ansible-or-python">I524: Why are there no homework to test me on skills such as ansible or python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i524-why-not-use-chef-or-another-devops-framework">I524: Why not use chef or another DevOps framework?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-lost">I am lost?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-do-not-like-technology-topic-project-etc">I do not like Technology/Topic/Project/etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-am-not-able-to-attend-the-online-hours">I am not able to attend the online hours</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-need-to-attend-the-online-sessions">Do I need to attend the online sessions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-leaning-outcomes">What are the leaning outcomes?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#there-are-so-many-messages-on-piazza-i-can-not-keep-up">There are so many messages on Piazza I can not keep up.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#i-do-not-know-python-what-do-i-do">I do not know python. What do I do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-techlist-1-homework">Tips: TechList.1 homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#citations">Citations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#spelling">Spelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#github">Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#rubric">Rubric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#timeliness">Timeliness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#outdated-tech-ology">Outdated Tech ology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#techlist-1-and-paper-1-pagecount">Techlist 1 and Paper 1 : Pagecount</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-to-install-virtualbox">Tips to Install Virtualbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#do-i-generate-the-ssh-key-on-ubuntu-vm">Do I generate the SSH key on Ubuntu VM ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#ways-to-run-ubuntu-on-windows-10">Ways to run Ubuntu on Windows 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#don-t-use-anaconda">Don’t use Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#using-ssh-key-for-git-push">Using SSH Key for Git Push</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#can-i-write-the-papers-on-osx">Can I write the papers on OSX?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-is-the-nature-of-team-collaboration-on-papers">What is the nature of team collaboration on papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#id1">What is the nature of team collaboration on papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-the-due-dates-for-assignments">What are the due dates for assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#what-are-good-places-to-find-refernce-entries">What are good places to find refernce entries?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-install-matplotlib">How to install Matplotlib?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#how-to-test-if-your-os-can-install-cloudmesh-client">How to test if your OS can install cloudmesh_client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#windows">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#os-x">OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#linux">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#tips-to-write-a-good-paper">Tips to write a Good Paper</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson/index.html">Lessons</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lesson/cloud/index.html">Cloud (under construction)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/contrib/index.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/doc/index.html">Writing Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/linux/index.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/org/index.html">Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/prg/index.html">Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/data/index.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/projects/index.html">Software Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/projects/draft.html">Software Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/iaas/index.html">IaaS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/docker/index.html">Docker Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/ansible/index.html">Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/chef.html">Chef</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/comparison.html">Compaprison of Configuration management software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/composite_cluster.html">Composite Clusters (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/deployment.html">Dynamic deployment of arbitrary X software on VC (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/hadoop.html">Hadoop Virtual Cluster Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/juju.html">Ubuntu Juju</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/mongodb_cluster.html">MongoDB Virtual Cluster (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/openmpi_cluster.html">OpenMPI Virtual Cluster (Under Preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/openstack_heat.html">OpenStack Heat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/other.html">Other (Under Preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/overview.html">DevOps (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/overview_vc.html">Overview Virtual Cluster (under preparation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/puppet.html">Puppet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/saltstack-ex1-output.html">Full Message of <code class="docutils literal"><span class="pre">salt-call</span></code> Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lesson/devops/saltstack.html">SaltStack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Notebooks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">Todos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../todo.html#general">General</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-unreleased">%%version%% (unreleased)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id1">3.2.0 (2017-08-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id5">3.1.1 (2017-02-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id10">3.1.0 (2017-02-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id15">3.0.9 (2017-01-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id20">3.0.8 (2017-01-22)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id24">3.0.7 (2017-01-20)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id29">3.0.6 (2017-01-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id32">3.0.5 (2017-01-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id37">3.0.4 (2017-01-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id38">3.0.3 (2017-01-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id41">3.0.2 (2017-01-07)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id42">3.0.1 (2017-01-06)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#id43">3.0 (2017-01-06)</a></li>
</ul>
</li>
</ul>
</ul>
</li><ul>
<li><a class="reference internal" href="#">NIST Pedestrian and Face Detection</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#inria-person-dataset">INRIA Person Dataset</a></li>
<li><a class="reference internal" href="#hog-with-svm-model">HOG with SVM model</a></li>
<li><a class="reference internal" href="#ansible-automation-tool">Ansible Automation Tool</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deployment-by-ansible">Deployment by Ansible</a></li>
<li><a class="reference internal" href="#cloudmesh-for-provisioning">Cloudmesh for Provisioning</a></li>
<li><a class="reference internal" href="#roles-explained-for-installation">Roles Explained for Installation</a><ul>
<li><a class="reference internal" href="#server-groups-for-masters-slaves-by-ansible-inventory">Server groups for Masters/Slaves by Ansible inventory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instructions-for-deployment">Instructions for Deployment</a><ul>
<li><a class="reference internal" href="#cloning-pedestrian-detection-repository-from-github">Cloning Pedestrian Detection Repository from Github</a></li>
<li><a class="reference internal" href="#ansible-playbook">Ansible Playbook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opencv-in-python">OpenCV in Python</a><ul>
<li><a class="reference internal" href="#import-cv2">Import cv2</a></li>
<li><a class="reference internal" href="#image-detection">Image Detection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#human-and-face-detection-in-opencv">Human and Face Detection in OpenCV</a><ul>
<li><a class="reference internal" href="#id1">INRIA Person Dataset</a></li>
<li><a class="reference internal" href="#face-detection-using-haar-cascades">Face Detection using Haar Cascades</a></li>
<li><a class="reference internal" href="#face-detection-python-code-snippet">Face Detection Python Code Snippet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pedestrian-detection-using-hog-descriptor">Pedestrian Detection using HOG Descriptor</a><ul>
<li><a class="reference internal" href="#python-code-snippet">Python Code Snippet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#processing-by-apache-spark">Processing by Apache Spark</a><ul>
<li><a class="reference internal" href="#parallelize-in-spark-context">Parallelize in Spark Context</a></li>
<li><a class="reference internal" href="#map-function-apply-batch">Map Function (apply_batch)</a></li>
<li><a class="reference internal" href="#collect-function">Collect Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results-for-100-images-by-spark-cluster">Results for 100+ images by Spark Cluster</a></li>
</ul>
</li>
</ul>
<p></p>
<hr>
<small>
<b>Web Links</b>
<ul>
    <li><a href="https://cloudmesh.github.io/classes/i523/2017">i523</a> </li>  
    <li><a href="https://cloudmesh.github.io/classes/i524">i524</a> </li>  

  </ul>
</small>

<p></p>
<hr>
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="nist-pedestrian-and-face-detection">
<h1>NIST Pedestrian and Face Detection<a class="headerlink" href="#nist-pedestrian-and-face-detection" title="Permalink to this headline">¶</a></h1>
<p>Pedestrian and Face Detection uses OpenCV to identify people standing in
a picture or a video and NIST use case in this document is built with
Apache Spark and Mesos clusters on multiple compute nodes.</p>
<p>The example in this tutorial deploys software packages on OpenStack
using Ansible with its roles.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Original</th>
<th class="head">Pedestrian Detected</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img alt="alt baby" src="https://raw.githubusercontent.com/lee212/classes/master/spring-2017/source/notebooks/files/image03.png" /></td>
<td><img alt="alt baby-detected" src="https://raw.githubusercontent.com/lee212/classes/master/spring-2017/source/notebooks/files/image05.png" /></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Original</th>
<th class="head">Pedestrian and Face/eyes Detected</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><img alt="alt person" src="https://raw.githubusercontent.com/lee212/classes/master/spring-2017/source/notebooks/files/image06.png" /></td>
<td><img alt="alt person-detected" src="https://raw.githubusercontent.com/lee212/classes/master/spring-2017/source/notebooks/files/image04.png" /></td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Human (pedestrian) detection and face detection have been studied during
the last several years and models for them have improved along with
Histograms of Oriented Gradients (HOG) for Human Detection [1]. OpenCV
is a Computer Vision library including the SVM classifier and the HOG
object detector for pedestrian detection and INRIA Person Dataset [2] is
one of popular samples for both training and testing purposes. In this
document, we deploy Apache Spark on Mesos clusters to train and apply
detection models from OpenCV using Python API.</p>
<div class="section" id="inria-person-dataset">
<h3>INRIA Person Dataset<a class="headerlink" href="#inria-person-dataset" title="Permalink to this headline">¶</a></h3>
<p>This dataset contains positive and negative images for training and test
purposes with annotation files for upright persons in each image. 288
positive test images, 453 negative test images, 614 positive training
images and 1218 negative training images are included along with
normalized 64x128 pixel formats. 970MB dataset is available to download
[3].</p>
</div>
<div class="section" id="hog-with-svm-model">
<h3>HOG with SVM model<a class="headerlink" href="#hog-with-svm-model" title="Permalink to this headline">¶</a></h3>
<p>Histogram of Oriented Gradient (HOG) and Support Vector Machine (SVM)
are used as object detectors and classifiers and built-in python
libraries from OpenCV provide these models for human detection.</p>
</div>
<div class="section" id="ansible-automation-tool">
<h3>Ansible Automation Tool<a class="headerlink" href="#ansible-automation-tool" title="Permalink to this headline">¶</a></h3>
<p>Ansible is a python tool to install/configure/manage software on
multiple machines with JSON files where system descriptions are defined.
There are reasons why we use Ansible:</p>
<ul class="simple">
<li>Expandable: Leverages Python (default) but modules can be written in
any language</li>
<li>Agentless: no setup required on managed node</li>
<li>Security: Allows deployment from user space; uses ssh for
authentication</li>
<li>Flexibility: only requires ssh access to privileged user</li>
<li>Transparency: YAML Based script files express the steps of installing
and configuring software</li>
<li>Modularity: Single Ansible Role (should) contain all required
commands and variables to deploy software package independently</li>
<li>Sharing and portability: roles are available from source (github,
bitbucket, gitlab, etc) or the Ansible Galaxy portal</li>
</ul>
<p>We use Ansible roles to install software packages for Humand and Face
Detection which requires to run OpenCV Python libraries on Apache Mesos
with a cluster configuration. Dataset is also downloaded from the web
using an ansible role.</p>
</div>
</div>
<div class="section" id="deployment-by-ansible">
<h2>Deployment by Ansible<a class="headerlink" href="#deployment-by-ansible" title="Permalink to this headline">¶</a></h2>
<p>Ansible is to deploy applications and build clusters for
batch-processing large datasets towards target machines e.g. VM
instances on OpenStack and we use ansible roles with <em>include</em> directive
to organize layers of big data software stacks (BDSS). Ansible provides
abstractions by Playbook Roles and reusability by Include statements. We
define X application in X Ansible Role, for example, and use include
statements to combine with other applications e.g. Y or Z. The layers
exist in sub directories (see below) to add modularity to your Ansible
deployment. For example, there are five roles used in this example that
are Apache Mesos in a scheduler layer, Apache Spark in a processing
layer, a OpenCV library in an application layer, INRIA Person Dataset in
a dataset layer and a python script for human and face detection in an
analytics layer. If you have an additional software package to add, you
can simply add a new role in a main ansible playbook with <em>include</em>
directive. With this, your Ansible playbook maintains simple but
flexible to add more roles without having a large single file which is
getting difficult to read when it deploys more applications on multiple
layers. The main Ansible playbook runs Ansible roles in order which look
like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="n">include</span><span class="p">:</span> <span class="n">sched</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">mesos</span><span class="o">.</span><span class="n">yml</span>
<span class="n">include</span><span class="p">:</span> <span class="n">proc</span><span class="o">/</span><span class="mi">01</span><span class="o">-</span><span class="n">spark</span><span class="o">.</span><span class="n">yml</span>
<span class="n">include</span><span class="p">:</span> <span class="n">apps</span><span class="o">/</span><span class="mi">02</span><span class="o">-</span><span class="n">opencv</span><span class="o">.</span><span class="n">yml</span>
<span class="n">include</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="mi">03</span><span class="o">-</span><span class="n">inria</span><span class="o">-</span><span class="n">dataset</span><span class="o">.</span><span class="n">yml</span>
<span class="n">Include</span><span class="p">:</span> <span class="n">anlys</span><span class="o">/</span><span class="mi">04</span><span class="o">-</span><span class="n">human</span><span class="o">-</span><span class="n">face</span><span class="o">-</span><span class="n">detection</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>Directory names e.g. sched, proc, data, or anlys indicate BDSS layers
like: - sched: scheduler layer - proc: data processing layer - apps:
application layer - data: dataset layer - anlys: analytics layer and two
digits in the filename indicate an order of roles to be run.</p>
</div>
<div class="section" id="cloudmesh-for-provisioning">
<h2>Cloudmesh for Provisioning<a class="headerlink" href="#cloudmesh-for-provisioning" title="Permalink to this headline">¶</a></h2>
<p>It is assumed that virtual machines are created by cloudmesh, the cloud
management software. For example on OpenStack,</p>
<p><code class="docutils literal"><span class="pre">cm</span> <span class="pre">cluster</span> <span class="pre">create</span> <span class="pre">-N=6</span></code></p>
<p>command starts a set of virtual machine instances. The number of
machines and groups for clusters e.g. namenodes and datanodes are
defined in the Ansible inventory file, a list of target machines with
groups, which will be generated once machines are ready to use by
cloudmesh. Ansible roles install software and dataset on virtual
clusters after that stage.</p>
</div>
<div class="section" id="roles-explained-for-installation">
<h2>Roles Explained for Installation<a class="headerlink" href="#roles-explained-for-installation" title="Permalink to this headline">¶</a></h2>
<p>Mesos role is installed first as a scheduler layer for masters and
slaves where mesos-master runs on the masters group and mesos-slave runs
on the slaves group. Apache Zookeeper is included in the mesos role
therefore mesos slaves find an elected mesos leader for the
coordination. Spark, as a data processing layer, provides two options
for distributed job processing, batch job processing via a cluster mode
and real-time processing via a client mode. The Mesos dispatcher runs on
a masters group to accept a batch job submission and Spark interactive
shell, which is the client mode, provides real-time processing on any
node in the cluster. Either way, Spark is installed later to detect a
master (leader) host for a job submission. Other roles for OpenCV, INRIA
Person Dataset and Human and Face Detection Python applications are
followed by.</p>
<p>The following software are expected in the stacks according to the
<a class="reference external" href="https://github.com/futuresystems/pedestrian-and-face-detection">github</a>:</p>
<ul class="simple">
<li>mesos cluster (master, worker)</li>
<li>spark (with dispatcher for mesos cluster mode)</li>
<li>openCV</li>
<li>zookeeper</li>
<li>INRIA Person Dataset</li>
<li>Detection Analytics in Python</li>
<li>[1] Dalal, Navneet, and Bill Triggs. “Histograms of oriented
gradients for human detection.” 2005 IEEE Computer Society Conference
on Computer Vision and Pattern Recognition (CVPR‘05). Vol. 1. IEEE,
2005. [pdf]</li>
<li>[2] <a class="reference external" href="http://pascal.inrialpes.fr/data/human/">http://pascal.inrialpes.fr/data/human/</a></li>
<li>[3] <a class="reference external" href="ftp://ftp.inrialpes.fr/pub/lear/douze/data/INRIAPerson.tar">ftp://ftp.inrialpes.fr/pub/lear/douze/data/INRIAPerson.tar</a></li>
<li>[4] <a class="reference external" href="https://docs.python.org/2/library/configparser.html">https://docs.python.org/2/library/configparser.html</a></li>
</ul>
<div class="section" id="server-groups-for-masters-slaves-by-ansible-inventory">
<h3>Server groups for Masters/Slaves by Ansible inventory<a class="headerlink" href="#server-groups-for-masters-slaves-by-ansible-inventory" title="Permalink to this headline">¶</a></h3>
<p>We may separate compute nodes in two groups: masters and workers
therefore Mesos masters and zookeeper quorums manage job requests and
leaders and workers run actual tasks. Ansible needs group definitions in
their inventory therefore software installation associated with a proper
part can be completed.</p>
<p>Example of Ansible Inventory file (inventory.txt)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">masters</span><span class="p">]</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.67</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.68</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.69</span>
<span class="p">[</span><span class="n">slaves</span><span class="p">]</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.70</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.71</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.72</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instructions-for-deployment">
<h2>Instructions for Deployment<a class="headerlink" href="#instructions-for-deployment" title="Permalink to this headline">¶</a></h2>
<p>The following commands complete NIST Pedestrian and Face Detection
deployment on OpenStack.</p>
<div class="section" id="cloning-pedestrian-detection-repository-from-github">
<h3>Cloning Pedestrian Detection Repository from Github<a class="headerlink" href="#cloning-pedestrian-detection-repository-from-github" title="Permalink to this headline">¶</a></h3>
<p>Roles are included as submodules which require <code class="docutils literal"><span class="pre">--recursive</span></code> option to
checkout them all.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!git clone --recursive https://github.com/futuresystems/pedestrian-and-face-detection.git
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>Cloning into &#39;pedestrian-and-face-detection&#39;...
remote: Counting objects: 81, done.[K
remote: Total 81 (delta 0), reused 0 (delta 0), pack-reused 81[K
Unpacking objects: 100% (81/81), done.
Checking connectivity... done.
Submodule &#39;roles/ansible-role-analytics&#39; (https://github.com/futuresystems/ansible-role-analytics.git) registered for path &#39;roles/ansible-role-analytics&#39;
Submodule &#39;roles/ansible-role-dataset&#39; (https://github.com/futuresystems/ansible-role-dataset.git) registered for path &#39;roles/ansible-role-dataset&#39;
Submodule &#39;roles/ansible-role-mesos-by-mesosphere&#39; (https://github.com/lee212/ansible-role-mesos-by-mesosphere.git) registered for path &#39;roles/ansible-role-mesos-by-mesosphere&#39;
Submodule &#39;roles/ansible-role-opencv&#39; (https://github.com/futuresystems/ansible-role-opencv) registered for path &#39;roles/ansible-role-opencv&#39;
Submodule &#39;roles/ansible-role-spark-for-mesos&#39; (https://github.com/lee212/ansible-role-spark-for-mesos.git) registered for path &#39;roles/ansible-role-spark-for-mesos&#39;
Cloning into &#39;roles/ansible-role-analytics&#39;...
remote: Counting objects: 29, done.[K
remote: Total 29 (delta 0), reused 0 (delta 0), pack-reused 29[K
Unpacking objects: 100% (29/29), done.
Checking connectivity... done.
Submodule path &#39;roles/ansible-role-analytics&#39;: checked out &#39;6fa1318af5b8d49e833b9042818c7ad4e52cbdc9&#39;
Cloning into &#39;roles/ansible-role-dataset&#39;...
remote: Counting objects: 21, done.[K
remote: Total 21 (delta 0), reused 0 (delta 0), pack-reused 21[K
Unpacking objects: 100% (21/21), done.
Checking connectivity... done.
Submodule path &#39;roles/ansible-role-dataset&#39;: checked out &#39;e6517790f8d30f7d75125a01772e8e57a547bb1f&#39;
Cloning into &#39;roles/ansible-role-mesos-by-mesosphere&#39;...
remote: Counting objects: 75, done.[K
remote: Total 75 (delta 0), reused 0 (delta 0), pack-reused 75[K
Unpacking objects: 100% (75/75), done.
Checking connectivity... done.
Submodule path &#39;roles/ansible-role-mesos-by-mesosphere&#39;: checked out &#39;402ed32ca03b5dc6610136bc00c0d30ed5d2215b&#39;
Cloning into &#39;roles/ansible-role-opencv&#39;...
remote: Counting objects: 36, done.[K
remote: Total 36 (delta 0), reused 0 (delta 0), pack-reused 36[K
Unpacking objects: 100% (36/36), done.
Checking connectivity... done.
Submodule path &#39;roles/ansible-role-opencv&#39;: checked out &#39;6b73c23334d74c2fcd40055ec6a8ae05d39fd65f&#39;
Cloning into &#39;roles/ansible-role-spark-for-mesos&#39;...
remote: Counting objects: 40, done.[K
remote: Total 40 (delta 0), reused 0 (delta 0), pack-reused 40[K
Unpacking objects: 100% (40/40), done.
Checking connectivity... done.
Submodule path &#39;roles/ansible-role-spark-for-mesos&#39;: checked out &#39;048d083a5fe7c4ed85d811e57a9301bc0a4a433f&#39;
</pre></div>
</div>
<p>Change the following variable with actual ip addresses:</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">sample_inventory</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;[masters]</span>
<span class="s2">10.0.5.67</span>
<span class="s2">10.0.5.68</span>
<span class="s2">10.0.5.69</span>
<span class="s2">[slaves]</span>
<span class="s2">10.0.5.70</span>
<span class="s2">10.0.5.71</span>
<span class="s2">10.0.5.72&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Create a <code class="docutils literal"><span class="pre">inventory.txt</span></code> file with the variable in your local
directory.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!printf &quot;$sample_inventory&quot; &gt; inventory.txt
!cat inventory.txt
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">masters</span><span class="p">]</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.67</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.68</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.69</span>
<span class="p">[</span><span class="n">slaves</span><span class="p">]</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.70</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.71</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">5.72</span>
</pre></div>
</div>
<p>Add <code class="docutils literal"><span class="pre">ansible.cfg</span></code> file with options for ssh host key checking and
login name.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>ansible_config=&quot;&quot;&quot;[defaults]
host_key_checking=false
remote_user=ubuntu&quot;&quot;&quot;
!printf &quot;$ansible_config&quot; &gt; ansible.cfg
!cat ansible.cfg
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">defaults</span><span class="p">]</span>
<span class="n">host_key_checking</span><span class="o">=</span><span class="n">false</span>
<span class="n">remote_user</span><span class="o">=</span><span class="n">ubuntu</span>
</pre></div>
</div>
<p>Check accessibility by ansible ping like:</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!ansible -m ping -i inventory.txt all
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>[0;32m10.0.5.70 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
[0;32m10.0.5.71 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
[0;32m10.0.5.68 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
[0;32m10.0.5.69 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
[0;32m10.0.5.67 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
[0;32m10.0.5.72 | SUCCESS =&gt; {
    &quot;changed&quot;: false,
    &quot;ping&quot;: &quot;pong&quot;
}[0m
</pre></div>
</div>
<p>Make sure that you have a correct ssh key in your account otherwise you
may encounter ‘FAILURE’ in the ping test above.</p>
</div>
<div class="section" id="ansible-playbook">
<h3>Ansible Playbook<a class="headerlink" href="#ansible-playbook" title="Permalink to this headline">¶</a></h3>
<p>We use a main ansible playbook to deploy software packages for NIST
Pedestrian and Face detection which includes: - mesos - spark -
zookeeper - opencv - INRIA Person dataset - Python script for the
detection</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!cd pedestrian-and-face-detection/ &amp;&amp; ansible-playbook -i ../inventory.txt site.yml
</pre></div>
</div>
<pre class="literal-block">
PLAY [mesos base] <strong>**********************************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : include_vars] <strong>*********************</strong>
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add apt-key] <strong>**********************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Remove mesosphere repo] <strong>***********</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : install mesos] <strong>********************</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : install zookeeperd if missing (on trusty)] <strong>*
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] ******************</strong>
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : remove myid] <strong>**********************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid update from ansibleshipyad] <strong>**</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : create dataDir if not exist] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid update in dataDir] <strong>***********</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] <strong>****************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-slave override] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-master override] <strong>************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable zk] <strong>***********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Downloading and enable the EPEL repository definitions.] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Install mesosphere] *****************</strong>
[0;36mskipping: [10.0.5.67] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.68] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.69] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.70] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=[]) [0m

TASK [ansible-role-mesos-by-mesosphere : Install zk] <strong>***********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] <strong>****************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid var] <strong>*************************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add lines in zoo.cfg.template to zoo.cfg] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] ******************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

PLAY [mesos masters] <strong>*******************************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : include_vars] <strong>*********************</strong>
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Add apt-key] <strong>**********************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Remove mesosphere repo] <strong>***********</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : install mesos] <strong>********************</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : install zookeeperd if missing (on trusty)] <strong>*
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] ******************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : remove myid] <strong>**********************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : myid update from ansibleshipyad] <strong>**</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : create dataDir if not exist] <strong>******</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : myid update in dataDir] <strong>***********</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] <strong>****************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-slave override] <strong>*************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-master override] <strong>************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : disable zk] <strong>***********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Downloading and enable the EPEL repository definitions.] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Install mesosphere] *****************</strong>
[0;36mskipping: [10.0.5.67] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.68] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.69] =&gt; (item=[]) [0m

TASK [ansible-role-mesos-by-mesosphere : Install zk] <strong>***********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] <strong>****************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : myid var] <strong>*************************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Add lines in zoo.cfg.template to zoo.cfg] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] ******************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m

RUNNING HANDLER [ansible-role-mesos-by-mesosphere : Restart zookeeper] <strong>*****</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.67][0m

PLAY [mesos slaves] <strong>********************************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : include_vars] <strong>*********************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add apt-key] <strong>**********************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : Remove mesosphere repo] <strong>***********</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : install mesos] <strong>********************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : install zookeeperd if missing (on trusty)] <strong>*
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] ******************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : remove myid] <strong>**********************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid update from ansibleshipyad] <strong>**</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : create dataDir if not exist] <strong>******</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid update in dataDir] <strong>***********</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] <strong>****************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;33mchanged: [10.0.5.72][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-slave override] <strong>*************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : mesos-master override] <strong>************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.71][0m

TASK [ansible-role-mesos-by-mesosphere : disable zk] <strong>***********************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add mesosphere repo] <strong>**************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Downloading and enable the EPEL repository definitions.] <strong>*
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Install mesosphere] *****************</strong>
[0;36mskipping: [10.0.5.70] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=[]) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=[]) [0m

TASK [ansible-role-mesos-by-mesosphere : Install zk] <strong>***********************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update /etc/hosts] <strong>****************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : myid var] <strong>*************************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set zoo.cfg.template] <strong>*************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Add lines in zoo.cfg.template to zoo.cfg] <strong>*
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : zookeeper systemd] ******************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : Define zk masters in mesos] <strong>*******</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : /etc/mesos/zk] <strong>********************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : set quorum: a number greater than # of masters divided by 2] <strong>*
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : update quorum on masters] ***********</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-slave on masters] <strong>******</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-slave on masters] <strong>***</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-master] <strong>*************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : stop mesos-master on slaves] <strong>******</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : disable mesos-master on masters] <strong>**</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-mesos-by-mesosphere : restart mesos-slave] <strong>**************</strong>
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

PLAY [spark for mesos] <strong>*****************************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-spark-for-mesos : unarchive spark directly (new in ansible 2.0)] <strong>*
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-spark-for-mesos : symlink to spark home] ******************</strong>
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-spark-for-mesos : spark configuration (spark-env.sh)] <strong>***</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

PLAY [opencv] <strong>**************************************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.69][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-opencv : compiler package] <strong>******************************</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-opencv : required packages] <strong>*****************************</strong>
[0;33mchanged: [10.0.5.71] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m
[0;33mchanged: [10.0.5.69] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m
[0;33mchanged: [10.0.5.70] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m
[0;33mchanged: [10.0.5.68] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m
[0;33mchanged: [10.0.5.67] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m
[0;33mchanged: [10.0.5.72] =&gt; (item=[u'cmake', u'git', u'libgtk2.0-dev', u'pkg-config', u'libavcodec-dev', u'libavformat-dev', u'libswscale-dev'])[0m

TASK [ansible-role-opencv : optional packages] <strong>*****************************</strong>
[0;33mchanged: [10.0.5.68] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m
[0;33mchanged: [10.0.5.69] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m
[0;33mchanged: [10.0.5.70] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m
[0;33mchanged: [10.0.5.67] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m
[0;33mchanged: [10.0.5.71] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m
[0;33mchanged: [10.0.5.72] =&gt; (item=[u'python-dev', u'python-numpy', u'libtbb2', u'libtbb-dev', u'libjpeg-dev', u'libpng-dev', u'libtiff-dev', u'libjasper-dev', u'libdc1394-22-dev'])[0m

TASK [ansible-role-opencv : Create a working directory] <strong>********************</strong>
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-opencv : git clone opencv (dev)] <strong>************************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.68][0m

TASK [ansible-role-opencv : download opencv (stable)] <strong>**********************</strong>
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-opencv : git clone opencv_contrib (dev)] <strong>****************</strong>
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.68][0m

TASK [ansible-role-opencv : git clone opencv_contrib (stable)] <strong>*************</strong>
[0;36mskipping: [10.0.5.67][0m
[0;36mskipping: [10.0.5.68][0m
[0;36mskipping: [10.0.5.69][0m
[0;36mskipping: [10.0.5.70][0m
[0;36mskipping: [10.0.5.71][0m
[0;36mskipping: [10.0.5.72][0m

TASK [ansible-role-opencv : remove build if exists] <strong>************************</strong>
[0;32mok: [10.0.5.68][0m
[0;32mok: [10.0.5.67][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m
[0;32mok: [10.0.5.69][0m

TASK [ansible-role-opencv : Create build directory] <strong>************************</strong>
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-opencv : Make the opencv build artifacts] <strong>***************</strong>
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-opencv : Compile opencv] <strong>********************************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-opencv : Install opencv] <strong>********************************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.69][0m
[0;33mchanged: [10.0.5.68][0m
[0;33mchanged: [10.0.5.67][0m
[0;33mchanged: [10.0.5.72][0m

PLAY [INRIA Person Dataset (for Human Detection)] <strong>**************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-dataset : Default dataset directory] <strong>********************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-dataset : INRIA Person Dataset] <strong>*************************</strong>
[0;33mchanged: [10.0.5.72][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.70][0m

PLAY [Human and Face Detection] <strong>********************************************</strong>

TASK [setup] <strong>***************************************************************</strong>
[0;32mok: [10.0.5.71][0m
[0;32mok: [10.0.5.70][0m
[0;32mok: [10.0.5.72][0m

TASK [ansible-role-analytics : Base directory for analytics] <strong>***************</strong>
[0;33mchanged: [10.0.5.70][0m
[0;33mchanged: [10.0.5.71][0m
[0;33mchanged: [10.0.5.72][0m

TASK [ansible-role-analytics : Python for Human and Face Detection by OpenCV] **
[0;36mskipping: [10.0.5.70] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection_by_spark.py) [0m
[0;36mskipping: [10.0.5.70] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection.py) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection_by_spark.py) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection.py) [0m
[0;36mskipping: [10.0.5.70] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_and_face_detection.py) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection_by_spark.py) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_detection.py) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_and_face_detection.py) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=/home/ubuntu/pedestrian-and-face-detection/roles/ansible-role-analytics/files/pedestrian_and_face_detection.py) [0m

TASK [ansible-role-analytics : Download XML classifiers of Face and Eye Detection by OpenCV] <strong>*
[0;36mskipping: [10.0.5.70] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml) [0m
[0;36mskipping: [10.0.5.70] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_eye.xml) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_eye.xml) [0m
[0;36mskipping: [10.0.5.71] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_eye.xml) [0m
[0;36mskipping: [10.0.5.72] =&gt; (item=https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml) [0m

PLAY RECAP *******************************************************************</strong>
[0;33m10.0.5.67[0m                  : [0;32mok=49  [0m [0;33mchanged=15  [0m unreachable=0    failed=0
[0;33m10.0.5.68[0m                  : [0;32mok=49  [0m [0;33mchanged=15  [0m unreachable=0    failed=0
[0;33m10.0.5.69[0m                  : [0;32mok=49  [0m [0;33mchanged=15  [0m unreachable=0    failed=0
[0;33m10.0.5.70[0m                  : [0;32mok=47  [0m [0;33mchanged=14  [0m unreachable=0    failed=0
[0;33m10.0.5.71[0m                  : [0;32mok=47  [0m [0;33mchanged=14  [0m unreachable=0    failed=0
[0;33m10.0.5.72[0m                  : [0;32mok=47  [0m [0;33mchanged=14  [0m unreachable=0    failed=0
</pre>
<p>The installation may take 30 minutes or an hour to complete.</p>
</div>
</div>
<div class="section" id="opencv-in-python">
<h2>OpenCV in Python<a class="headerlink" href="#opencv-in-python" title="Permalink to this headline">¶</a></h2>
<p>Before we run our code for this project, let’s try OpenCV first to see
how it works.</p>
<div class="section" id="import-cv2">
<h3>Import cv2<a class="headerlink" href="#import-cv2" title="Permalink to this headline">¶</a></h3>
<p>Let’s import opencv python module and we will use images from the online
database image-net.org to test OpenCV image recognition.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
</pre></div>
</div>
<p>Let’s download a mailbox image with a red color to see if opencv
identifies the shape with a color. The example file in this tutorial is:</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!curl http://farm4.static.flickr.com/3061/2739199963_ee78af76ef.jpg &gt; mailbox.jpg
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">167</span><span class="n">k</span>  <span class="mi">100</span>  <span class="mi">167</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">686</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>  <span class="mi">684</span><span class="n">k</span>
</pre></div>
</div>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">mailbox_image</span> <span class="o">=</span> <span class="s2">&quot;mailbox.jpg&quot;</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">mailbox_image</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/facedetection_46_0.jpeg" src="../_images/facedetection_46_0.jpeg" />
<p>You can try other images. Check out the image-net.org for mailbox
images: <a class="reference external" href="http://image-net.org/synset?wnid=n03710193">http://image-net.org/synset?wnid=n03710193</a></p>
</div>
<div class="section" id="image-detection">
<h3>Image Detection<a class="headerlink" href="#image-detection" title="Permalink to this headline">¶</a></h3>
<p>Just for a test, let’s try to detect a red color shaped mailbox using
opencv python functions.</p>
<p>There are key functions that we use: * cvtColor: to convert a color
space of an image * inRange: to detect a mailbox based on the range of
red color pixel values * np.array: to define the range of red color
using a Numpy library for better calculation * findContours: to find a
outline of the object * bitwise_and: to black-out the area of contours
found</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># imread for loading an image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">mailbox_image</span><span class="p">)</span>
<span class="c1"># cvtColor for color conversion</span>
<span class="n">hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>

<span class="c1"># define range of red color in hsv</span>
<span class="n">lower_red1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">upper_red1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
<span class="n">lower_red2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">170</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">upper_red2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>

<span class="c1"># threshold the hsv image to get only red colors</span>
<span class="n">mask1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">lower_red1</span><span class="p">,</span> <span class="n">upper_red1</span><span class="p">)</span>
<span class="n">mask2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">hsv</span><span class="p">,</span> <span class="n">lower_red2</span><span class="p">,</span> <span class="n">upper_red2</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">mask1</span> <span class="o">+</span> <span class="n">mask2</span>

<span class="c1"># find a red color mailbox from the image</span>
<span class="n">im2</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span><span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)</span>

<span class="c1"># bitwise_and to remove other areas in the image except the detected object</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">)</span>

<span class="c1"># turn off - x, y axis bar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="c1"># text for the masked image</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;masked image&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">))</span>
<span class="c1"># display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/facedetection_49_0.png" src="../_images/facedetection_49_0.png" />
<p>The red color mailbox is left alone in the image which we wanted to find
in this example by opencv functions. You can try other images with
different colors to detect the different shape of objects using
findContours and inRange from opencv.</p>
<p>For more information, see the useful links below.</p>
<ul class="simple">
<li>contours features:
<a class="reference external" href="http://docs.opencv.org/3.1.0/dd/d49/tutorial_py_contour_features.html">http://docs.opencv.org/3.1.0/dd/d49/tutorial_py_contour_features.html</a></li>
<li>contours:
<a class="reference external" href="http://docs.opencv.org/3.1.0/d4/d73/tutorial_py_contours_begin.html">http://docs.opencv.org/3.1.0/d4/d73/tutorial_py_contours_begin.html</a></li>
<li>red color in hsv:
<a class="reference external" href="http://stackoverflow.com/questions/30331944/finding-red-color-using-python-opencv">http://stackoverflow.com/questions/30331944/finding-red-color-using-python-opencv</a></li>
<li>inrange:
<a class="reference external" href="http://docs.opencv.org/master/da/d97/tutorial_threshold_inRange.html">http://docs.opencv.org/master/da/d97/tutorial_threshold_inRange.html</a></li>
<li>inrange:
<a class="reference external" href="http://docs.opencv.org/3.0-beta/doc/py_tutorials/py_imgproc/py_colorspaces/py_colorspaces.html">http://docs.opencv.org/3.0-beta/doc/py_tutorials/py_imgproc/py_colorspaces/py_colorspaces.html</a></li>
<li>numpy:
<a class="reference external" href="http://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html">http://docs.opencv.org/3.0-beta/doc/py_tutorials/py_core/py_basic_ops/py_basic_ops.html</a></li>
</ul>
</div>
</div>
<div class="section" id="human-and-face-detection-in-opencv">
<h2>Human and Face Detection in OpenCV<a class="headerlink" href="#human-and-face-detection-in-opencv" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>INRIA Person Dataset<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We use INRIA Person dataset to detect upright people and faces in images
in this example. Let’s download it first.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!curl ftp://ftp.inrialpes.fr/pub/lear/douze/data/INRIAPerson.tar &gt; INRIAPerson.tar
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">969</span><span class="n">M</span>  <span class="mi">100</span>  <span class="mi">969</span><span class="n">M</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">8480</span><span class="n">k</span>      <span class="mi">0</span>  <span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">57</span>  <span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">57</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mf">12.4</span><span class="n">M</span>
</pre></div>
</div>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!tar xvf INRIAPerson.tar &gt; logfile &amp;&amp; tail logfile
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_191b</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_207a</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_207b</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_208a</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_208b</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_209a</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">/</span><span class="n">person_and_bike_209b</span><span class="o">.</span><span class="n">png</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">pos</span><span class="o">.</span><span class="n">lst</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">neg</span>
<span class="n">INRIAPerson</span><span class="o">/</span><span class="n">train_64x128_H96</span><span class="o">/</span><span class="n">neg</span><span class="o">.</span><span class="n">lst</span>
</pre></div>
</div>
</div>
<div class="section" id="face-detection-using-haar-cascades">
<h3>Face Detection using Haar Cascades<a class="headerlink" href="#face-detection-using-haar-cascades" title="Permalink to this headline">¶</a></h3>
<p>This section is prepared based on the opencv-python tutorial:
<a class="reference external" href="http://docs.opencv.org/3.1.0/d7/d8b/tutorial_py_face_detection.html#gsc.tab=0">http://docs.opencv.org/3.1.0/d7/d8b/tutorial_py_face_detection.html#gsc.tab=0</a></p>
<p>There is a pre-trained classifier for face detection, download it from
here:</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span>!curl https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml &gt; haarcascade_frontalface_default.xml
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">908</span><span class="n">k</span>  <span class="mi">100</span>  <span class="mi">908</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>  <span class="mi">2225</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="mi">2259</span><span class="n">k</span>
</pre></div>
</div>
<p>This classifier XML file will be used to detect faces in images. If you
like to create a new classifier, find out more information about
training from here:
<a class="reference external" href="http://docs.opencv.org/3.1.0/dc/d88/tutorial_traincascade.html">http://docs.opencv.org/3.1.0/dc/d88/tutorial_traincascade.html</a></p>
</div>
<div class="section" id="face-detection-python-code-snippet">
<h3>Face Detection Python Code Snippet<a class="headerlink" href="#face-detection-python-code-snippet" title="Permalink to this headline">¶</a></h3>
<p>Now, we detect faces from the first five images using the classifier.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># import the necessary packages</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="k">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">mypath</span> <span class="o">=</span> <span class="s2">&quot;INRIAPerson/Test/pos/&quot;</span>
<span class="n">face_cascade</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="s1">&#39;haarcascade_frontalface_default.xml&#39;</span><span class="p">)</span>

<span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">join</span><span class="p">(</span><span class="n">mypath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">mypath</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">mypath</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>

<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">onlyfiles</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">image_grayscale</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
    <span class="n">faces</span> <span class="o">=</span> <span class="n">face_cascade</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image_grayscale</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">faces</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="n">cnt_faces</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="s2">&quot;face&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cnt_faces</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">],</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
        <span class="n">cnt_faces</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<img alt="../_images/facedetection_59_0.png" src="../_images/facedetection_59_0.png" />
<img alt="../_images/facedetection_59_1.png" src="../_images/facedetection_59_1.png" />
<img alt="../_images/facedetection_59_2.png" src="../_images/facedetection_59_2.png" />
<img alt="../_images/facedetection_59_3.png" src="../_images/facedetection_59_3.png" />
<img alt="../_images/facedetection_59_4.png" src="../_images/facedetection_59_4.png" />
<img alt="../_images/facedetection_59_5.png" src="../_images/facedetection_59_5.png" />
<img alt="../_images/facedetection_59_6.png" src="../_images/facedetection_59_6.png" />
<img alt="../_images/facedetection_59_7.png" src="../_images/facedetection_59_7.png" />
<img alt="../_images/facedetection_59_8.png" src="../_images/facedetection_59_8.png" />
<img alt="../_images/facedetection_59_9.png" src="../_images/facedetection_59_9.png" />
<img alt="../_images/facedetection_59_10.png" src="../_images/facedetection_59_10.png" />
</div>
</div>
<div class="section" id="pedestrian-detection-using-hog-descriptor">
<h2>Pedestrian Detection using HOG Descriptor<a class="headerlink" href="#pedestrian-detection-using-hog-descriptor" title="Permalink to this headline">¶</a></h2>
<p>We will use Histogram of Oriented Gradients (HOG) to detect a upright
person from images.</p>
<div class="section" id="python-code-snippet">
<h3>Python Code Snippet<a class="headerlink" href="#python-code-snippet" title="Permalink to this headline">¶</a></h3>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># initialize the HOG descriptor/person detector</span>
<span class="n">hog</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HOGDescriptor</span><span class="p">()</span>
<span class="n">hog</span><span class="o">.</span><span class="n">setSVMDetector</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">HOGDescriptor_getDefaultPeopleDetector</span><span class="p">())</span>

<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">onlyfiles</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">orig</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

    <span class="c1"># detect people in the image</span>
    <span class="p">(</span><span class="n">rects</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="o">=</span> <span class="n">hog</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">winStride</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

    <span class="c1"># draw the final bounding boxes</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<img alt="../_images/facedetection_62_0.png" src="../_images/facedetection_62_0.png" />
<img alt="../_images/facedetection_62_1.png" src="../_images/facedetection_62_1.png" />
<img alt="../_images/facedetection_62_2.png" src="../_images/facedetection_62_2.png" />
<img alt="../_images/facedetection_62_3.png" src="../_images/facedetection_62_3.png" />
<img alt="../_images/facedetection_62_4.png" src="../_images/facedetection_62_4.png" />
<img alt="../_images/facedetection_62_5.png" src="../_images/facedetection_62_5.png" />
<img alt="../_images/facedetection_62_6.png" src="../_images/facedetection_62_6.png" />
<img alt="../_images/facedetection_62_7.png" src="../_images/facedetection_62_7.png" />
<img alt="../_images/facedetection_62_8.png" src="../_images/facedetection_62_8.png" />
<img alt="../_images/facedetection_62_9.png" src="../_images/facedetection_62_9.png" />
</div>
</div>
<div class="section" id="processing-by-apache-spark">
<h2>Processing by Apache Spark<a class="headerlink" href="#processing-by-apache-spark" title="Permalink to this headline">¶</a></h2>
<p>INRIA Person dataset provides 100+ images and Spark can be used for
image processing in parallel. We load 288 images from “Test/pos”
directory.</p>
<p>Spark provides a special object ‘sc’ to connect between a spark cluster
and functions in python code. Therefore, we can run python functions in
parallel to detet objects in this example.</p>
<ul class="simple">
<li><em>map</em> function is used to process pedestrian and face detection per
image from the parallelize() function of ‘sc’ spark context.</li>
<li><em>collect</em> fonction merges results in an array.</li>
</ul>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_batch</span><span class="p">(</span><span class="n">imagePath</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">cv2</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="c1"># initialize the HOG descriptor/person detector</span>
        <span class="n">hog</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">HOGDescriptor</span><span class="p">()</span>
        <span class="n">hog</span><span class="o">.</span><span class="n">setSVMDetector</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">HOGDescriptor_getDefaultPeopleDetector</span><span class="p">())</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">imagePath</span><span class="p">)</span>
        <span class="c1"># detect people in the image</span>
        <span class="p">(</span><span class="n">rects</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="o">=</span> <span class="n">hog</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">winStride</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="c1"># draw the final bounding boxes</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rects</span><span class="p">:</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">image</span>
</pre></div>
</div>
<div class="section" id="parallelize-in-spark-context">
<h3>Parallelize in Spark Context<a class="headerlink" href="#parallelize-in-spark-context" title="Permalink to this headline">¶</a></h3>
<p>The list of image files is given to parallelize.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">pd</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">onlyfiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="map-function-apply-batch">
<h3>Map Function (apply_batch)<a class="headerlink" href="#map-function-apply-batch" title="Permalink to this headline">¶</a></h3>
<p>The ‘apply_batch’ function that we created above is given to map
function to process in a spark cluster.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">pdc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">apply_batch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="collect-function">
<h3>Collect Function<a class="headerlink" href="#collect-function" title="Permalink to this headline">¶</a></h3>
<p>The result of each map process is merged to an array.</p>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pdc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="results-for-100-images-by-spark-cluster">
<h2>Results for 100+ images by Spark Cluster<a class="headerlink" href="#results-for-100-images-by-spark-cluster" title="Permalink to this headline">¶</a></h2>
<div class="code ipython2 highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Gregor von Laszewski.<br/>
    </p>
  </div>
</footer>
  </body>
</html>